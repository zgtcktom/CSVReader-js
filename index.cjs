!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};async function*n(e){let t=e.getReader();for(;;){let{done:e,value:n}=await t.read();if(e)break;yield n}}e.r(t),e.d(t,{CSVReader:()=>a});let o=async e=>{let t={async*[Symbol.asyncIterator](){for(;;){let{done:e,value:t}=await new Promise(((e,t)=>{onmessage=t=>{e(t.data)}}));if(e)break;yield t}}};onmessage=async n=>{let o=n.data;postMessage(await e(...o,t)),close()}},r=e=>{onmessage=t=>{let n=t.data;postMessage(e(...n)),close()}},i=(e,t)=>(importScripts(e),main(...t)),l=async(e,t,n)=>(importScripts(e),await main(...t,n));async function s(e,t=[],n=0){if("string"==typeof e)return n?s(l,[e,t],n):s(i,[e,t]);let a;if("function"==typeof e){let t="("+(n?o:r).toString()+")("+e.toString()+");",i=new Blob([t],{type:"application/javascript"});a=new Worker(URL.createObjectURL(i))}if(a.postMessage(t),n){for await(let e of n)a.postMessage({done:!1,value:e});a.postMessage({done:!0,value:null})}return new Promise(((e,t)=>{a.onmessage=t=>{e(t.data),a.postMessage("asd")},a.onerror=e=>{t(e)}}))}const a=function e(t,o){if("undefined"!=typeof WorkerGlobalScope&&this instanceof WorkerGlobalScope)return async function(){let e,n,r,i,s=0;for await(let a of o)[e,n,r,i]=l(a,t,e,n,r,i),s++;return i.length&&r.push(i),r.length&&n.push(r),console.log("postMessage count:",s),n}();function r(t,n){if(n.worker)return console.log("readSync: use worker"),s(e,[n],[t]);let[o,r,i,a]=l(t,n);return a.length&&i.push(a),i.length&&r.push(i),r}async function i(t,o){if(o.worker)return console.log("readAsync: use worker"),s(e,[o],n(t));let r,i,a,c,u=0;for await(let e of n(t))u++,[r,i,a,c]=l(e,o,r,i,a,c);return c.length&&a.push(c),a.length&&i.push(a),console.log("loaded",u,"chunks"),i}function l(e,t,n=null,o=[],r=[],i=""){let{delimiter:l,lineTerminator:s,doubleQuote:a,quoteChar:c,skipInitialSpace:u,commentChar:d}=t,f=0,g=-2,p=-2,h=a?c:c+c;if(3==n){if(-1!=p&&p<f&&(p=e.indexOf(s,f)),-1==p)return[3,o,r,""];f=p+s.length,n=null}if(1==n&&(e[f]==c?(i+=h,f+=1,n=0):n=2),0==n){for(;;){let t=e.indexOf(c,f);if(-1==t)return[0,o,r,i+e.slice(f)];if(i+=e.slice(f,t),f=t+1,f>=e.length)return[1,o,r,i];if(e[f]!=c)break;i+=h,f+=1}n=2}if(2==n){if(g=e.indexOf(l,f),p=e.indexOf(s,f),-1==g&&-1==p)return[2,o,r,i+e.slice(f)];-1==p||-1!=g&&g<p?(i+=e.slice(f,g),f=g+l.length,r.push(i),i=""):(i+=e.slice(f,p),f=p+s.length,r.push(i),i="",o.push(r),r=[])}for(;f<e.length;){if(u)for(;" "==e[f];f++);let t=e[f];if(d&&t==d){if(-1!=p&&p<f&&(p=e.indexOf(s,f)),-1==p)return[3,o,r,""];f=p+s.length,t=e[f]}if(t==c)for(f+=1;;){let t=e.indexOf(c,f);if(-1==t)return[0,o,r,i+e.slice(f)];if(i+=e.slice(f,t),f=t+1,f>=e.length)return[1,o,r,i];if(e[f]!=c)break;i+=h,f+=1}if(-1!=g&&g<f&&(g=e.indexOf(l,f)),-1!=p&&p<f&&(p=e.indexOf(s,f)),-1==g&&-1==p)return[2,o,r,i+e.slice(f)];-1==p||-1!=g&&g<p?(i+=e.slice(f,g),f=g+l.length,r.push(i),i=""):(i+=e.slice(f,p),f=p+s.length,r.push(i),i="",o.push(r),r=[])}return[null,o,r,i]}function a(e,{delimiter:t=",",lineTerminator:n="\n",doubleQuote:o=!0,quoteChar:r='"'}={}){return e.map((e=>e.map((e=>(((e=e.toString()).includes(r)||e.includes(t)||e.includes(n))&&(e='"'+(o?e.replaceAll(r,r+r):e)+'"'),e))).join(t))).join(n)+n}return class{static stringify=a;constructor(e,{worker:t=!1,delimiter:n=",",lineTerminator:o="\n",doubleQuote:l=!0,quoteChar:s='"',skipInitialSpace:a=!1,commentChar:c="#"}={}){if(1!=s.length)throw new Error("quoteChar must be one-character");if(1!=c.length)throw new Error("commentChar must be one-character");let u={worker:t,delimiter:n,lineTerminator:o,doubleQuote:l,quoteChar:s,skipInitialSpace:a,commentChar:c};if("string"==typeof e)this.read=r.bind(this,e,u);else{if(!(e instanceof ReadableStream))throw new Error("unexpected input type");this.read=i.bind(this,e,u)}}}}();let c;async function u(e){let t,n,o,r=c.files[0];console.log(r);let i={skipInitialSpace:!0,doubleQuote:!0};console.time();let l=new a(new ReadableStream({start(e){let t=new FileReader;t.addEventListener("load",(()=>{let n,o=t.result;for(let t=0;t<o.length;t+=n)n=Math.trunc(999*Math.random()+1),e.enqueue(o.slice(t,t+n));e.close()})),t.readAsText(r)}}),i);console.log(l),o=await l.read(),t=o,console.timeEnd(),console.log(o),console.time(),o=await new Promise((e=>{let t=new FileReader;t.addEventListener("load",(()=>{let n=new a(t.result,i);e(n.read())})),t.readAsText(r)})),n=o,console.timeEnd(),console.log(o),console.log(t!=n,JSON.stringify(t)==JSON.stringify(n),{chunked:JSON.stringify(t),full:JSON.stringify(n)}),console.time(),l=new a(new ReadableStream({start(e){let t=new FileReader;t.addEventListener("load",(()=>{let n,o=t.result;for(let t=0;t<o.length;t+=n)n=Math.trunc(999*Math.random()+1),e.enqueue(o.slice(t,t+n));e.close()})),t.readAsText(r)}}),{worker:!0,...i}),console.log(l),o=await l.read(),t=o,console.timeEnd(),console.log(o),console.time(),o=await new Promise((e=>{let t=new FileReader;t.addEventListener("load",(()=>{let n=new a(t.result,{worker:!0,...i});e(n.read())})),t.readAsText(r)})),n=o,console.timeEnd(),console.log(o),console.log(t!=n,JSON.stringify(t)==JSON.stringify(n),{chunked:JSON.stringify(t),full:JSON.stringify(n)});let s=a.stringify(t,{...i});console.log({string:s}),console.log(JSON.stringify(new a(s,{...i}).read())==JSON.stringify(t))}return window.addEventListener("load",(function(){document.body.innerHTML+='\n<input type="file"><button>read</button>\n\t',c=document.querySelector("input"),c.oninput=u,document.querySelector("button").onclick=u})),t})()));